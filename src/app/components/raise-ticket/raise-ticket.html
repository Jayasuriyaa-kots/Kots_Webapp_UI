<div class="raise-ticket-container">
    <header class="header">
        <button class="back-btn" (click)="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18L9 12L15 6" stroke="white" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </button>
        <div class="header-center">

            <span class="booking-id">{{ bookingId }}</span>
        </div>
        <button class="notification-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            <span class="dot"></span>
        </button>
    </header>

    <h1 class="page-title">New ticket</h1>

    <section class="form-group">
        <label>Select the category</label>
        <div class="select-wrapper">
            <select [(ngModel)]="selectedCategory" (change)="onCategoryChange()">
                <option value="" disabled selected hidden></option>
                <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
            </select>
            <div class="select-arrow">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
        </div>
    </section>

    <section class="form-group" *ngIf="availableSubcategories.length > 0">
        <label>Select the subcategory</label>
        <div class="select-wrapper">
            <select [(ngModel)]="selectedSubcategory">
                <option value="" disabled selected hidden></option>
                <option *ngFor="let sub of availableSubcategories" [value]="sub">{{ sub }}</option>
            </select>
            <div class="select-arrow">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </div>
        </div>
    </section>

    <section class="form-group">
        <label>Describe the Issue</label>
        <textarea [(ngModel)]="description" rows="5"></textarea>
    </section>

    <section class="form-group upload-section">
        <label>Upload Documents</label>

        <!-- Hidden file inputs -->
        <input type="file" #cameraInput accept="image/*" capture="environment" (change)="onFileSelected($event)"
            style="display: none;">

        <input type="file" #fileInput accept="image/*" multiple (change)="onFileSelected($event)"
            style="display: none;">

        <div class="upload-buttons">
            <button class="upload-btn" type="button" (click)="cameraInput.click()">
                <div class="icon-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="#a6942e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z">
                        </path>
                        <circle cx="12" cy="13" r="4"></circle>
                    </svg>
                </div>
                <span>Take Photo</span>
            </button>
            <button class="upload-btn" type="button" (click)="fileInput.click()">
                <div class="icon-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="#a6942e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                </div>
                <span>Add Photo</span>
            </button>
        </div>

        <!-- Photo Preview Grid -->
        <div *ngIf="uploadedPhotos.length > 0" class="photo-preview-grid">
            <div class="photo-item" *ngFor="let photo of uploadedPhotos; let i = index">
                <img [src]="photo.preview" [alt]="photo.name">
                <button class="remove-photo-btn" (click)="removePhoto(i)" type="button">Ã—</button>
                <span class="photo-name">{{ photo.name }}</span>
            </div>
        </div>
    </section>

    <button class="submit-btn" (click)="submitTicket()">Raise ticket</button>
</div>