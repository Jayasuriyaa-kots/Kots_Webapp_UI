<div class="documents-container">
    <!-- Header -->
    <header class="header">
        <button class="back-btn" (click)="goBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6" />
            </svg>
        </button>

        <div class="header-center">
            <div class="booking-id">{{ userId || 'Loading...' }}</div>
        </div>

        <button class="notification-btn" (click)="openNotifications()">
            <img src="assets/images/notification-icon.svg" alt="Notifications" />
        </button>
    </header>

    <!-- Content -->
    <section class="content-section">
        <h1 class="page-title">Documents</h1>

        <!-- Loading -->
        @if(loading) {
        <div class="loading-state">
            <div class="spinner"></div>
            <p>Loading documents...</p>
        </div>
        }

        <!-- Error -->
        @if(error) {
        <div class="error-state">
            <p>{{ error }}</p>
            <button class="retry-btn" (click)="loadDocuments(userId)">Retry</button>
        </div>
        }

        <!-- Sections -->
        @if(!loading && !error) {

        <!-- ═══ Section 1: Document Sign Requests ═══ -->
        @if(signRequests.length > 0) {
        <div class="section">
            <div class="section-header">
                <div class="section-icon sign-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 000-1.41l-2.34-2.34a1 1 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z" />
                    </svg>
                </div>
                <h2 class="section-title">Document Sign Request</h2>
            </div>

            <div class="cards-list">
                @for(doc of signRequests; track doc.id) {
                <div class="doc-card sign-card">
                    <div class="doc-card-body">
                        <div class="doc-card-icon">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                            </svg>
                        </div>
                        <div class="doc-card-info">
                            <span class="doc-title">{{ doc.document_title }}</span>
                            <span class="doc-meta">Required by: {{ formatDate(doc.required_date) }}</span>
                        </div>
                    </div>
                    <button class="sign-btn" (click)="openSignUrl(doc.sign_url)">
                        Sign Now
                    </button>
                </div>
                }
            </div>
        </div>
        }

        <!-- ═══ Section 2: Signed Documents ═══ -->
        @if(signedDocuments.length > 0) {
        <div class="section">
            <div class="section-header">
                <div class="section-icon signed-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" />
                    </svg>
                </div>
                <h2 class="section-title">Signed Documents</h2>
            </div>

            <div class="cards-list">
                @for(doc of signedDocuments; track doc.id) {
                <div class="doc-card signed-card">
                    <div class="doc-card-body">
                        <div class="doc-card-icon pdf-icon">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                            </svg>
                        </div>
                        <div class="doc-card-info">
                            <span class="doc-title">{{ doc.document_title }}</span>
                            <span class="doc-meta">Received: {{ formatDate(doc.email_received_at) }}</span>
                        </div>
                    </div>
                    <button class="download-btn" (click)="downloadPdf(doc.id, doc.document_title)">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
                        </svg>
                        PDF
                    </button>
                </div>
                }
            </div>
        </div>
        }

        <!-- ═══ Section 3: CIR Documents ═══ -->
        @if(cirDocuments.length > 0) {
        <div class="section">
            <div class="section-header">
                <div class="section-icon cir-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z" />
                    </svg>
                </div>
                <h2 class="section-title">CIR Documents</h2>
            </div>

            <div class="cards-list">
                @for(doc of cirDocuments; track doc.id) {
                <div class="doc-card cir-card">
                    <div class="doc-card-body">
                        <div class="doc-card-icon pdf-icon">
                            <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                            </svg>
                        </div>
                        <div class="doc-card-info">
                            <span class="doc-title">{{ doc.document_title }}</span>
                            <span class="doc-meta">Received: {{ formatDate(doc.email_received_at) }}</span>
                        </div>
                    </div>
                    <button class="download-btn" (click)="downloadPdf(doc.id, doc.document_title)">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" />
                        </svg>
                        PDF
                    </button>
                </div>
                }
            </div>
        </div>
        }

        <!-- Empty state -->
        @if(!hasAnyDocuments) {
        <div class="empty-state">
            <div class="empty-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
                    <path
                        d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                </svg>
            </div>
            <p class="empty-text">No documents available</p>
            <p class="empty-subtext">Documents will appear here once they are processed</p>
        </div>
        }

        }
    </section>
</div>